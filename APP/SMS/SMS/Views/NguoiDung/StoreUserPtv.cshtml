@model SMS.Models.StoreAndUserList
@using PagedList.Mvc;

<script>
    function Cancel(userId, storeId) {
        //alert("Cancle permission " + userId + " - " + storeId);
        $.ajax({
            url: "/NguoiDung/CancelPermission",
            data: "{'userId' : '" + userId + "', 'storeId' : '" + storeId + "'}",
            dataType: "json", type: "POST", contentType: "application/json; charset=utf-8",
            success:
                function (data) {
                    $.each(data, function (i, item) {
                        alert(item);
                    });
                    $('#mainForm').submit();
                },
            error:
                function (XMLHttpRequest, textStatus, errorThrown) { alert(textStatus); }
        });
        //return false;
    };

    function SetPermission(userId, storeId) {
        //alert("Set permission " + userId + " - " + storeId);
        //return false;
        $.ajax({
            url: "/NguoiDung/SetPermission",
            data: "{'userId' : '" + userId + "', 'storeId' : '" + storeId + "'}",
            dataType: "json", type: "POST", contentType: "application/json; charset=utf-8",
            success:
                function (data) {
                    $.each(data, function (i, item) {
                        alert(item);
                    });
                    $('#mainForm').submit();
                },

            error:
                function (XMLHttpRequest, textStatus, errorThrown) { alert(textStatus); }
        });
    };

    function SetDefault(userId, storeId) {
        //alert("Set Default " + userId + " - " + storeId);
        //return false;
        $.ajax({
            url: "/NguoiDung/SetDefaultPermission",
            data: "{'userId' : '" + userId + "', 'storeId' : '" + storeId + "'}",
            dataType: "json", type: "POST", contentType: "application/json; charset=utf-8",
            success:
                function (data) {
                    $.each(data, function (i, item) {
                        alert(item);
                    });
                    $('#mainForm').submit();
                },
            error:
                function (XMLHttpRequest, textStatus, errorThrown) { alert(textStatus); }
        });
    };
    
</script>
<table width="100%">
    <tr style="width:100%">
        <td class='innerLast colwidth head ' width="20px;"> STT </td>
        <td class='innerLast colwidth head ' width="15%"> Tên người dùng </td>
        @{
            int i = 0;
            foreach (var Kho in Model.Stores)
            {
                i++;
                if (i <= 9)
                {
                    <td class='innerLast colwidth head '>
                        @Kho.TEN_KHO
                    </td>
                }
            }
        }
    </tr>
    @{
        int jj =0;
        if (Model.StoresUser != null && Model.StoresUser.Count > 0)
        {
            foreach (var tonKho in Model.StoresUser)
            {
                jj++;
                <tr>
                    <td class="innerLast colwidth"> @jj</td>
                    <td class="innerLast colwidth"> @tonKho.USR_NAME  </td>
                    @{
                int j = 0;
                foreach (var Kho in Model.Stores)
                {
                    j++;
                    if (j <= 9)
                    {
                        switch (j)
                        {
                            case 1:

                                if (tonKho.KHO_ID_1 == 0)
                                {
                                    <td class="innerLast colwidth align-left" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                        <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_1 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_1 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }

                                break;
                            case 2:
                                if (tonKho.KHO_ID_2 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_2 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_2 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 3:

                                if (tonKho.KHO_ID_3 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_3 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_3 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 4:

                                if (tonKho.KHO_ID_4 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_4 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_4 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 5:
                                if (tonKho.KHO_ID_5 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_5 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_5 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 6:
                                if (tonKho.KHO_ID_6 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_6 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_6 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 7:
                                if (tonKho.KHO_ID_7 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_7 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)"/>
                                       <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_7 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 8:

                                if (tonKho.KHO_ID_8 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                        <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                    }
                                    else if (tonKho.KHO_ID_8 == 2)
                                    {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                        <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                    }
                                else if (tonKho.KHO_ID_8 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                            case 9:

                                if (tonKho.KHO_ID_9 == 0)
                                {
                                    <td class="innerLast colwidth" style="background-color:darkgray">
                                        <input type="button" value="C" onclick="return SetPermission(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                        <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_9 == 2)
                                {
                                    <td class="innerLast colwidth alignCenter" style="background-color:lightyellow">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                        <input type="button" value="D" onclick="return SetDefault(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                else if (tonKho.KHO_ID_9 == 3)
                                {
                                    <td class="innerLast colwidth alignNumberic" style="background-color:lightsalmon">
                                        <input type="button" value="H" onclick="return Cancel(@tonKho.USR_ID, @Kho.MA_KHO)" />
                                    </td>
                                }
                                break;
                        }
                    }
                }
}
                </tr>
            }
        }
        else
        {
            int colspan = 2 + i;
            <tr>
                <td colspan="@colspan" class="innerLast alignCenter" style="background-color:lightgray">Tất cả các sản phẩm đều có số lượng tồn trong vùng an toàn.</td>
            </tr>
        }
    }
</table>


